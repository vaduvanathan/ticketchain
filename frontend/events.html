<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TicketChain ‚Äî Events</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Rubik:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/theme.css">
  <style>
    /* Events-specific styles that extend theme.css */
    .actions { 
      display: flex; 
      gap: 12px; 
    }
    
    .events-list { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
      gap: 16px; 
    }
    
    .event-item { 
      background: #f8f9fa; 
      padding: 16px; 
      border-radius: 14px; 
      border-left: 4px solid var(--red-2); 
    }
    
    .event-item h4 { 
      margin: 0 0 8px; 
      color: var(--red-1); 
    }
    
    .event-meta { 
      font-size: 0.9rem; 
      color: #666; 
      margin-bottom: 8px; 
    }
    
    .loading { 
      margin-top: 8px; 
      color: var(--muted); 
    }
  </style>
</head>
<body>
  <div class="shell">
    <header class="topbar">
      <div class="brand"><span class="icon">e</span> <span>ticketchain</span></div>
      <div class="actions">
        <a class="ghost" href="./login.html">Login</a>
        <a class="ghost" href="./register.html">Register</a>
      </div>
    </header>

    <section class="card">
      <h3>Upcoming Events</h3>
      <div id="loading" class="loading">Loading events...</div>
      <div id="events" class="events-list"></div>
    </section>
  </div>

  <script>
    const API_BASE = '';
    async function loadEventsPublic() {
      const loading = document.getElementById('loading');
      const list = document.getElementById('events');
      try {
        const res = await fetch(`${API_BASE}/events`).catch(() => null);
        if (!res) { loading.textContent = 'Backend not reachable.'; return; }
        const data = await res.json().catch(()=>({events:[]}));
        loading.style.display = 'none';
        list.innerHTML = '';
        if (!data.events || data.events.length === 0) {
          list.innerHTML = '<div>No events yet.</div>';
          return;
        }
        const seen = new Set();
        data.events.forEach(ev => {
          if (seen.has(ev.id)) return; seen.add(ev.id);
          const div = document.createElement('div');
          div.className = 'event-item';
          div.innerHTML = `
            <h4>${ev.title}</h4>
            <div class="event-meta">üìç ${ev.location || 'TBD'} | üìÖ ${new Date(ev.date_time).toLocaleString()}</div>
            <p>${ev.description || 'No description'}</p>
          `;
          list.appendChild(div);
        });
      } catch (e) {
        loading.textContent = 'Failed to load events.';
      }
    }
    document.addEventListener('DOMContentLoaded', loadEventsPublic);
  </script>
</body>
</html>