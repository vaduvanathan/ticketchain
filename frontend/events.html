<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TicketChain ‚Äî Events</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Rubik:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/theme.css">
  <style>
    :root {
      --bg: #ffe9ea; --panel: #ffffff; --red-1: #c20e17; --red-2: #ed2b2b; --red-3: #8e0b12; --text: #2b2b2b; --muted: #7a7a7a; --shadow: rgba(139,0,0,.15);
    }
    * { box-sizing: border-box; }
    body { margin: 0; min-height: 100vh; background: linear-gradient(180deg,#ffeef0,#ffe3e6); font-family: 'Rubik', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: var(--text); }
    .shell { max-width: 1200px; margin: 0 auto; padding: 18px 20px 40px; }
    .topbar { display:flex; align-items:center; justify-content:space-between; }
    .brand { display:inline-flex; align-items:center; gap:10px; background:#fff; padding:10px 14px; border-radius:14px; box-shadow:0 6px 18px var(--shadow); border:2px solid #f4d6d8; font-weight:800; color:var(--red-1); font-family:'Orbitron',sans-serif; }
    .brand .icon { width:26px; height:26px; border-radius:8px; background: linear-gradient(135deg,var(--red-2),var(--red-1)); display:grid; place-items:center; color:#fff; }
    .actions { display:flex; gap:12px; }
    .ghost { background:#fff; padding:10px 14px; border-radius:999px; border:2px solid #f4d6d8; color:var(--red-1); font-weight:700; box-shadow:0 6px 18px var(--shadow); text-decoration:none; }
    .card { background:#fff; border:2px solid #f4d6d8; border-radius:22px; padding:24px; margin-top:18px; box-shadow:0 12px 32px var(--shadow); }
    .card h3 { margin:0 0 12px; color:var(--red-1); font-family:'Orbitron',sans-serif; }
    .events-list { display:grid; grid-template-columns: repeat(auto-fit,minmax(320px,1fr)); gap:16px; }
    .event-item { background:#f8f9fa; padding:16px; border-radius:14px; border-left:4px solid var(--red-2); }
    .event-item h4 { margin:0 0 8px; color:var(--red-1); }
    .event-meta { font-size:.9rem; color:#666; margin-bottom:8px; }
    .loading { margin-top:8px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="shell">
    <header class="topbar">
      <div class="brand"><span class="icon">e</span> <span>ticketchain</span></div>
      <div class="actions">
        <a class="ghost" href="./login.html">Login</a>
        <a class="ghost" href="./register.html">Register</a>
      </div>
    </header>

    <section class="card">
      <h3>Upcoming Events</h3>
      <div id="loading" class="loading">Loading events...</div>
      <div id="events" class="events-list"></div>
    </section>
  </div>

  <script>
    const API_BASE = window.location.origin;
    async function loadEventsPublic() {
      const loading = document.getElementById('loading');
      const list = document.getElementById('events');
      try {
        const res = await fetch(`${API_BASE}/events`).catch(() => null);
        if (!res) { loading.textContent = 'Backend not reachable.'; return; }
        const data = await res.json().catch(()=>({events:[]}));
        loading.style.display = 'none';
        list.innerHTML = '';
        if (!data.events || data.events.length === 0) {
          list.innerHTML = '<div>No events yet.</div>';
          return;
        }
        const seen = new Set();
        data.events.forEach(ev => {
          if (seen.has(ev.id)) return; seen.add(ev.id);
          const div = document.createElement('div');
          div.className = 'event-item';
          div.innerHTML = `
            <h4>${ev.title}</h4>
            <div class="event-meta">üìç ${ev.location || 'TBD'} | üìÖ ${new Date(ev.date_time).toLocaleString()}</div>
            <p>${ev.description || 'No description'}</p>
          `;
          list.appendChild(div);
        });
      } catch (e) {
        loading.textContent = 'Failed to load events.';
      }
    }
    document.addEventListener('DOMContentLoaded', loadEventsPublic);
  </script>
</body>
</html>